#!/usr/bin/env python3
"""
Generate SQL script to create all 404 user accounts
Structure: 4 PTGÄ â†’ 16 GÄKD â†’ 64 TLKD â†’ 320 GiÃ¡m sÃ¡t
"""

# Region mapping
regions = {
    'bd': {'id': 1, 'name': 'BÃ¬nh DÆ°Æ¡ng', 'short': 'bd'},
    'hn': {'id': 2, 'name': 'HÃ  Ná»™i', 'short': 'hn'},
    'mt': {'id': 3, 'name': 'Miá»n Trung', 'short': 'mt'},
    'hcm': {'id': 4, 'name': 'Há»“ ChÃ­ Minh', 'short': 'hcm'}
}

# PTGÄ list from image
ptgd_list = [
    {'name': 'Nguyá»…n Quá»‘c Trung', 'region': 'bd', 'username': 'ptgd_binhduong'},
    {'name': 'Äá»— Äá»©c ChÃ­', 'region': 'hn', 'username': 'ptgd_hanoi'},
    {'name': 'VÅ© Quang Hoan', 'region': 'hcm', 'username': 'ptgd_hochiminh'},
    {'name': 'LÃª Thá»‹ BÃ­ch Háº¡nh', 'region': 'mt', 'username': 'ptgd_mientrung'}
]

# Vietnamese surnames
surnames = ['Tráº§n', 'LÃª', 'Pháº¡m', 'HoÃ ng', 'Huá»³nh', 'Phan', 'VÃµ', 'Äáº·ng', 'BÃ¹i', 'Äá»—',
            'Há»“', 'NgÃ´', 'DÆ°Æ¡ng', 'LÃ½', 'VÆ°Æ¡ng', 'Äinh', 'Mai', 'LÃ¢m', 'Táº¡', 'Cao']

middle_names = ['VÄƒn', 'Thá»‹', 'CÃ´ng', 'Minh', 'Äá»©c', 'Quá»‘c', 'Há»¯u', 'Thanh', 'Ngá»c', 'Anh']

given_names = ['An', 'BÃ¬nh', 'Chi', 'Dung', 'Giang', 'HÃ ', 'HÆ°Æ¡ng', 'KhÃ¡nh', 'Linh', 'Mai',
               'Nam', 'Oanh', 'PhÃºc', 'Quá»³nh', 'SÆ¡n', 'Trang', 'UyÃªn', 'VÃ¢n', 'XuÃ¢n', 'Yáº¿n']

# SQL template
INSERT_TEMPLATE = "INSERT INTO users (username, password, full_name, region_id, position_id, start_date, manager_id)\nVALUES ('{}', '123456', '{}', {}, {}, '{}', {});\n"

def generate_name(index):
    """Generate Vietnamese full name"""
    surname = surnames[index % len(surnames)]
    middle = middle_names[index % len(middle_names)]
    given = given_names[index % len(given_names)]
    return f"{surname} {middle} {given}"

def main():
    output = []
    output.append("-- " + "="*80)
    output.append("-- AUTO-GENERATED SQL SCRIPT - Táº O 404 TÃ€I KHOáº¢N")
    output.append("-- Cáº¥u trÃºc: 4 PTGÄ â†’ 16 GÄKD â†’ 64 TLKD â†’ 320 GiÃ¡m sÃ¡t")
    output.append("-- Generated by: generate_users.py")
    output.append("-- " + "="*80 + "\n")
    
    current_user_id = 17  # Start from ID 17 (after existing 16 users + admin)
    
    # ===== 1. CREATE 4 PTGÄ =====
    output.append("-- " + "="*80)
    output.append("-- 1. Táº O 4 PTGÄ (PhÃ³ Tá»•ng GiÃ¡m Äá»‘c)")
    output.append("-- " + "="*80 + "\n")
    
    ptgd_ids = {}
    for ptgd in ptgd_list:
        region_id = regions[ptgd['region']]['id']
        output.append(f"-- PTGÄ {regions[ptgd['region']]['name']} (ID: {current_user_id})")
        output.append(INSERT_TEMPLATE.format(
            ptgd['username'],
            ptgd['name'],
            region_id,
            1,  # position_id for PTGÄ
            '2020-01-15',
            'NULL'  # No manager
        ))
        ptgd_ids[ptgd['region']] = current_user_id
        current_user_id += 1
    
    output.append("")
    
    # ===== 2. CREATE 16 GÄKD (4 per PTGÄ) =====
    output.append("-- " + "="*80)
    output.append("-- 2. Táº O 16 GÄKD (4 GÄKD cho má»—i PTGÄ)")
    output.append("-- " + "="*80 + "\n")
    
    gdkd_ids = {}
    gdkd_count = 0
    
    for region_key in ['bd', 'hn', 'hcm', 'mt']:
        region = regions[region_key]
        gdkd_ids[region_key] = []
        
        output.append(f"-- GÄKD cho PTGÄ {region['name']} (IDs: {current_user_id}-{current_user_id+3})")
        
        for i in range(4):
            username = f"gdkd_{region['short']}_{i+1:02d}"
            full_name = generate_name(gdkd_count)
            
            output.append(INSERT_TEMPLATE.format(
                username,
                full_name,
                region['id'],
                2,  # position_id for GÄKD
                f"2020-{5+i:02d}-01",
                ptgd_ids[region_key]
            ))
            
            gdkd_ids[region_key].append(current_user_id)
            current_user_id += 1
            gdkd_count += 1
        
        output.append("")
    
    # ===== 3. CREATE 64 TLKD (4 per GÄKD) =====
    output.append("-- " + "="*80)
    output.append("-- 3. Táº O 64 TLKD (4 TLKD cho má»—i GÄKD)")
    output.append("-- " + "="*80 + "\n")
    
    tlkd_ids = {}
    tlkd_count = 0
    month_counter = 1
    
    for region_key in ['bd', 'hn', 'hcm', 'mt']:
        region = regions[region_key]
        tlkd_ids[region_key] = []
        
        for gdkd_idx, gdkd_id in enumerate(gdkd_ids[region_key]):
            tlkd_ids[region_key].append([])
            
            output.append(f"-- TLKD cho GÄKD {region['name']} {gdkd_idx+1:02d} (IDs: {current_user_id}-{current_user_id+3})")
            
            for i in range(4):
                username = f"tlkd_{region['short']}_{gdkd_idx+1:02d}_{i+1:02d}"
                full_name = generate_name(tlkd_count)
                
                year = 2021 + (month_counter // 12)
                month = (month_counter % 12) + 1
                
                output.append(INSERT_TEMPLATE.format(
                    username,
                    full_name,
                    region['id'],
                    3,  # position_id for TLKD
                    f"{year}-{month:02d}-{(i+1)*10:02d}",
                    gdkd_id
                ))
                
                tlkd_ids[region_key][-1].append(current_user_id)
                current_user_id += 1
                tlkd_count += 1
                month_counter += 1
            
            output.append("")
    
    # ===== 4. CREATE 320 GIÃM SÃT (5 per TLKD) =====
    output.append("-- " + "="*80)
    output.append("-- 4. Táº O 320 GIÃM SÃT (5 GiÃ¡m sÃ¡t cho má»—i TLKD)")
    output.append("-- " + "="*80 + "\n")
    
    gs_count = 1
    year = 2022
    month = 10
    day = 20
    
    for region_key in ['bd', 'hn', 'hcm', 'mt']:
        region = regions[region_key]
        
        for gdkd_idx, gdkd_tlkd_list in enumerate(tlkd_ids[region_key]):
            for tlkd_idx, tlkd_id in enumerate(gdkd_tlkd_list):
                output.append(f"-- GiÃ¡m sÃ¡t cho TLKD {region['short'].upper()} {gdkd_idx+1:02d} {tlkd_idx+1:02d} (IDs: {current_user_id}-{current_user_id+4})")
                
                for i in range(5):
                    username = f"gs_{region['short']}_{gdkd_idx+1:02d}_{tlkd_idx+1:02d}_{i+1:02d}"
                    full_name = f"Test {gs_count} GiÃ¡m sÃ¡t"
                    
                    output.append(INSERT_TEMPLATE.format(
                        username,
                        full_name,
                        region['id'],
                        4,  # position_id for GiÃ¡m sÃ¡t
                        f"{year}-{month:02d}-{day:02d}",
                        tlkd_id
                    ))
                    
                    current_user_id += 1
                    gs_count += 1
                    
                    # Increment date
                    day += 10
                    if day > 28:
                        day = 1
                        month += 1
                        if month > 12:
                            month = 1
                            year += 1
                
                output.append("")
    
    # Summary
    output.append("-- " + "="*80)
    output.append(f"-- Tá»”NG Sá» TÃ€I KHOáº¢N ÄÃƒ Táº O: {current_user_id - 17}")
    output.append(f"-- 4 PTGÄ + 16 GÄKD + 64 TLKD + 320 GiÃ¡m sÃ¡t = {current_user_id - 17} tÃ i khoáº£n")
    output.append("-- Máº­t kháº©u máº·c Ä‘á»‹nh: 123456")
    output.append("-- " + "="*80)
    
    # Write to file
    with open('/home/user/webapp/create_all_users_full.sql', 'w', encoding='utf-8') as f:
        f.write('\n'.join(output))
    
    print(f"âœ… Generated SQL script with {current_user_id - 17} users")
    print(f"   - 4 PTGÄ")
    print(f"   - 16 GÄKD")
    print(f"   - 64 TLKD")
    print(f"   - 320 GiÃ¡m sÃ¡t")
    print(f"   Total: {current_user_id - 17} users")
    print(f"\nğŸ“ Output file: /home/user/webapp/create_all_users_full.sql")

if __name__ == '__main__':
    main()
