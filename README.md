# Há»‡ thá»‘ng Quáº£n lÃ½ KPI - CÃ´ng ty NhÃ¢n Kiá»‡t

## MÃ´ táº£ dá»± Ã¡n

Há»‡ thá»‘ng quáº£n lÃ½ KPI (Key Performance Indicators) cho cÃ´ng ty NhÃ¢n Kiá»‡t, há»— trá»£ 4 khá»‘i váº­n hÃ nh (BÃ¬nh DÆ°Æ¡ng, HÃ  Ná»™i, Miá»n Trung, Há»“ ChÃ­ Minh) vá»›i 4 cáº¥p báº­c quáº£n lÃ½.

## TÃ­nh nÄƒng chÃ­nh

### âœ… ÄÃ£ hoÃ n thÃ nh

1. **Há»‡ thá»‘ng Ä‘Äƒng nháº­p**
   - XÃ¡c thá»±c ngÆ°á»i dÃ¹ng theo tÃ i khoáº£n
   - PhÃ¢n quyá»n theo vá»‹ trÃ­ vÃ  khá»‘i váº­n hÃ nh
   - 16 tÃ i khoáº£n nhÃ¢n viÃªn + 1 tÃ i khoáº£n Admin
   - Tá»± Ä‘á»™ng phÃ¢n quyá»n chá»©c nÄƒng theo vai trÃ²

2. **Giao diá»‡n 3 tab riÃªng biá»‡t (cho nhÃ¢n viÃªn)**
   - **Tab "Nháº­p KPI"**: Form nháº­p cÃ¡c chá»‰ sá»‘ KPI theo thÃ¡ng/nÄƒm
   - **Tab "Nháº­p Level"**: Hiá»ƒn thá»‹ Level tá»± Ä‘á»™ng Ä‘iá»n tá»« KPI
   - **Tab "Dashboard"**: Xem tá»•ng há»£p KPI/Level toÃ n cÃ´ng ty
   - Thiáº¿t káº¿ hiá»‡n Ä‘áº¡i vá»›i gradient, animations, responsive

3. **TÃ­nh nÄƒng Auto-fill Level (Táº¤T Cáº¢ vá»‹ trÃ­)**
   - âœ¨ **Tá»± Ä‘á»™ng sao chÃ©p** dá»¯ liá»‡u tá»« KPI sang Level
   - âœ¨ **Tá»± Ä‘á»™ng tÃ­nh sá»‘ nÄƒm kinh nghiá»‡m** tá»« ngÃ y nháº­n viá»‡c
   - âœ¨ **KhÃ´ng cáº§n nháº­p Level thá»§ cÃ´ng** - chá»‰ cáº§n nháº­p KPI
   - Ãp dá»¥ng cho: PTGÄ, GÄKD, Trá»£ lÃ½ KD, GiÃ¡m sÃ¡t

4. **Trang Admin - Quáº£n lÃ½ ngÆ°á»i dÃ¹ng**
   - ğŸ” DÃ nh riÃªng cho tÃ i khoáº£n **admin** / **admin123**
   - Xem danh sÃ¡ch 16 ngÆ°á»i dÃ¹ng (theo khá»‘i vÃ  vá»‹ trÃ­)
   - **Nháº­p/sá»­a ngÃ y nháº­n viá»‡c** cho tá»«ng ngÆ°á»i
   - Tá»± Ä‘á»™ng tÃ­nh sá»‘ nÄƒm thÃ¢m niÃªn khi lÆ°u KPI

5. **Quáº£n lÃ½ KPI theo vá»‹ trÃ­**
   - **PTGÄ (PhÃ³ Tá»•ng GiÃ¡m Ä‘á»‘c)**: 6 chá»‰ sá»‘ KPI, 4 chá»‰ sá»‘ Level
   - **GÄKD (GiÃ¡m Ä‘á»‘c Kinh doanh)**: 6 chá»‰ sá»‘ KPI, 4 chá»‰ sá»‘ Level
   - **Trá»£ lÃ½ Kinh doanh**: 6 chá»‰ sá»‘ KPI, 4 chá»‰ sá»‘ Level
   - **GiÃ¡m sÃ¡t**: 6 chá»‰ sá»‘ KPI, 4 chá»‰ sá»‘ Level

6. **TÃ­nh toÃ¡n tá»± Ä‘á»™ng**
   - Tá»•ng Ä‘iá»ƒm KPI (max 150%)
   - Xáº¿p loáº¡i KPI: ChÆ°a Ä‘áº¡t / Äáº¡t chuáº©n / KhÃ¡ / Tá»‘t
   - Tá»•ng Ä‘iá»ƒm Level
   - Xáº¿p loáº¡i Level: Xem xÃ©t láº¡i / Level 1-5

7. **Dashboard tá»•ng há»£p**
   - Xem KPI vÃ  Level cá»§a toÃ n cÃ´ng ty
   - PhÃ¢n nhÃ³m theo 4 khá»‘i váº­n hÃ nh
   - Hiá»ƒn thá»‹ Ä‘iá»ƒm sá»‘ vÃ  xáº¿p loáº¡i
   - Lá»c theo thÃ¡ng/nÄƒm

## Cáº¥u trÃºc dá»¯ liá»‡u

### Database (Cloudflare D1)

- **regions**: 4 khá»‘i váº­n hÃ nh (BÃ¬nh DÆ°Æ¡ng, HÃ  Ná»™i, Miá»n Trung, TP.HCM)
- **positions**: 4 vá»‹ trÃ­ (PTGÄ, GÄKD, Trá»£ lÃ½ KD, GiÃ¡m sÃ¡t)
- **users**: 16 tÃ i khoáº£n ngÆ°á»i dÃ¹ng
- **kpi_templates**: 40 máº«u KPI theo tá»«ng vá»‹ trÃ­ (20 KPI + 20 Level)
- **kpi_data**: Dá»¯ liá»‡u KPI nháº­p vÃ o
- **monthly_summary**: Tá»•ng há»£p Ä‘iá»ƒm KPI vÃ  Level theo thÃ¡ng

### API Endpoints

```
POST   /api/login                               - ÄÄƒng nháº­p
GET    /api/kpi-templates/:positionId           - Láº¥y máº«u KPI theo vá»‹ trÃ­
GET    /api/kpi-data/:userId/:year/:month       - Láº¥y dá»¯ liá»‡u KPI Ä‘Ã£ nháº­p
POST   /api/kpi-data                            - LÆ°u dá»¯ liá»‡u KPI (auto-fill Level)
GET    /api/summary/:userId/:year/:month        - Láº¥y tá»•ng há»£p KPI/Level
GET    /api/dashboard/:year/:month              - Dashboard toÃ n cÃ´ng ty
GET    /api/admin/users                         - Láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng (admin)
PUT    /api/admin/users/:userId                 - Cáº­p nháº­t ngÃ y nháº­n viá»‡c (admin)
```

## HÆ°á»›ng dáº«n sá»­ dá»¥ng

### 1. ÄÄƒng nháº­p Admin

**TÃ i khoáº£n Admin:**
- Username: `admin`
- Password: `admin123`

**Chá»©c nÄƒng Admin:**
- Quáº£n lÃ½ danh sÃ¡ch 16 ngÆ°á»i dÃ¹ng
- Nháº­p/sá»­a **ngÃ y nháº­n viá»‡c** cho tá»«ng ngÆ°á»i
- Há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng tÃ­nh sá»‘ nÄƒm kinh nghiá»‡m

### 2. ÄÄƒng nháº­p nhÃ¢n viÃªn

Sá»­ dá»¥ng má»™t trong 16 tÃ i khoáº£n máº«u:

**PTGÄ:**
- `ptgd_binhduong` / `123456`
- `ptgd_hanoi` / `123456`
- `ptgd_mientrung` / `123456`
- `ptgd_hcm` / `123456`

**GiÃ¡m Ä‘á»‘c Kinh doanh:**
- `gdkd_binhduong` / `123456`
- `gdkd_hanoi` / `123456`
- `gdkd_mientrung` / `123456`
- `gdkd_hcm` / `123456`

**Trá»£ lÃ½ Kinh doanh:**
- `tlkd_binhduong` / `123456`
- `tlkd_hanoi` / `123456`
- `tlkd_mientrung` / `123456`
- `tlkd_hcm` / `123456`

**GiÃ¡m sÃ¡t:**
- `gs_binhduong` / `123456`
- `gs_hanoi` / `123456`
- `gs_mientrung` / `123456`
- `gs_hcm` / `123456`

### 3. Nháº­p KPI (Tab 1)

1. Chá»n **thÃ¡ng/nÄƒm** cáº§n nháº­p
2. Click **"Táº£i dá»¯ liá»‡u"** Ä‘á»ƒ load form KPI
3. Nháº­p giÃ¡ trá»‹ thá»±c táº¿ vÃ o **6 chá»‰ sá»‘ KPI**
4. Click **"LÆ°u dá»¯ liá»‡u KPI"**
5. âœ¨ Há»‡ thá»‘ng tá»± Ä‘á»™ng:
   - TÃ­nh % hoÃ n thÃ nh vÃ  Ä‘iá»ƒm sá»‘
   - **Tá»± Ä‘á»™ng Ä‘iá»n Level tá»« KPI Ä‘Ã£ nháº­p**
   - TÃ­nh sá»‘ nÄƒm kinh nghiá»‡m tá»« ngÃ y nháº­n viá»‡c

### 4. Xem Level (Tab 2)

1. Chuyá»ƒn sang tab **"Nháº­p Level"**
2. Chá»n thÃ¡ng/nÄƒm vÃ  click **"Táº£i dá»¯ liá»‡u"**
3. Xem Level Ä‘Ã£ Ä‘Æ°á»£c tá»± Ä‘á»™ng Ä‘iá»n:
   - âœ… **GiÃ¡ trá»‹ thá»±c táº¿** (tá»« KPI)
   - âœ… **% HoÃ n thÃ nh** (tá»± Ä‘á»™ng tÃ­nh)
   - âœ… **Äiá»ƒm cÃ³ trá»ng sá»‘** (tá»± Ä‘á»™ng tÃ­nh)
4. Xem tá»•ng káº¿t Ä‘iá»ƒm Level vÃ  xáº¿p loáº¡i

### 5. Xem Dashboard (Tab 3)

1. Chuyá»ƒn sang tab **"Dashboard"**
2. Chá»n thÃ¡ng/nÄƒm muá»‘n xem
3. Xem káº¿t quáº£ KPI vÃ  Level cá»§a **toÃ n cÃ´ng ty**
4. Dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n nhÃ³m theo 4 khá»‘i váº­n hÃ nh

## URLs

- **Development (Local)**: https://3000-ij9pq6vc2kegdr3doxjys-0e616f0a.sandbox.novita.ai
- **Production**: Sáº½ deploy lÃªn Cloudflare Pages

## Tech Stack

- **Backend**: Hono (Edge Framework)
- **Frontend**: Vanilla JavaScript + Tailwind CSS
- **Database**: Cloudflare D1 (SQLite)
- **Deployment**: Cloudflare Pages
- **Runtime**: Cloudflare Workers

## CÃ´ng thá»©c tÃ­nh Ä‘iá»ƒm

### Äiá»ƒm KPI
```
% HoÃ n thÃ nh = (GiÃ¡ trá»‹ thá»±c táº¿ / GiÃ¡ trá»‹ chuáº©n) Ã— 100% (max 150%)
Äiá»ƒm cÃ³ trá»ng sá»‘ = (% HoÃ n thÃ nh / 100) Ã— Trá»ng sá»‘
Tá»•ng Ä‘iá»ƒm KPI = Î£ Äiá»ƒm cÃ³ trá»ng sá»‘
```

### Xáº¿p loáº¡i KPI
- **ChÆ°a Ä‘áº¡t**: < 100%
- **Äáº¡t chuáº©n**: â‰¥ 100%
- **KhÃ¡**: â‰¥ 120%
- **Tá»‘t**: â‰¥ 140%

### Xáº¿p loáº¡i Level
- **Xem xÃ©t láº¡i**: < 50%
- **Level 1**: 50% - 80%
- **Level 2**: 81% - 100%
- **Level 3**: 101% - 120%
- **Level 4**: 121% - 140%
- **Level 5**: â‰¥ 140%

(Ghi chÃº: CÃ´ng thá»©c cÃ³ thá»ƒ thay Ä‘á»•i theo tá»«ng vá»‹ trÃ­)

## CÃ i Ä‘áº·t vÃ  Cháº¡y Local

```bash
# Clone repository
git clone <repository-url>
cd webapp

# CÃ i Ä‘áº·t dependencies
npm install

# Apply database migrations
npm run db:migrate:local

# Build project
npm run build

# Start development server
npm run dev:sandbox
# hoáº·c dÃ¹ng PM2:
pm2 start ecosystem.config.cjs

# Test
curl http://localhost:3000
```

## Deploy lÃªn Cloudflare Pages

```bash
# Táº¡o D1 database trÃªn Cloudflare
npx wrangler d1 create webapp-production

# Cáº­p nháº­t database_id trong wrangler.jsonc

# Apply migrations
npm run db:migrate:prod

# Deploy
npm run deploy:prod
```

## TÃ­nh nÄƒng sáº½ phÃ¡t triá»ƒn

- [ ] Xuáº¥t bÃ¡o cÃ¡o Excel
- [ ] Biá»ƒu Ä‘á»“ trá»±c quan hÃ³a dá»¯ liá»‡u KPI
- [ ] So sÃ¡nh KPI giá»¯a cÃ¡c thÃ¡ng
- [ ] ThÃ´ng bÃ¡o khi KPI khÃ´ng Ä‘áº¡t chuáº©n
- [ ] TÃ¹y chá»‰nh máº«u KPI theo cÃ´ng ty
- [ ] Lá»‹ch sá»­ thay Ä‘á»•i dá»¯ liá»‡u KPI
- [ ] PhÃ¢n tÃ­ch xu hÆ°á»›ng KPI theo thá»i gian

## Cáº¥u trÃºc thÆ° má»¥c

```
webapp/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ index.tsx           # Backend API (Hono)
â”œâ”€â”€ public/
â”‚   â””â”€â”€ static/
â”‚       â””â”€â”€ app.js          # Frontend JavaScript
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ 0001_initial_schema.sql
â”‚   â”œâ”€â”€ 0002_kpi_templates.sql
â”‚   â”œâ”€â”€ 0003_sample_users.sql
â”‚   â”œâ”€â”€ 0004_add_start_date.sql
â”‚   â””â”€â”€ 0005_add_admin.sql
â”œâ”€â”€ ecosystem.config.cjs    # PM2 configuration
â”œâ”€â”€ wrangler.jsonc          # Cloudflare configuration
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## Giáº¥y phÃ©p

Thuá»™c quyá»n sá»Ÿ há»¯u cá»§a CÃ´ng ty NhÃ¢n Kiá»‡t

## LiÃªn há»‡

Äá»ƒ Ä‘Æ°á»£c há»— trá»£ hoáº·c Ä‘Ã³ng gÃ³p Ã½ kiáº¿n, vui lÃ²ng liÃªn há»‡ bá»™ pháº­n IT cá»§a cÃ´ng ty.
